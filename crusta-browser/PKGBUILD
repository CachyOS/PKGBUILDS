# Maintainer: pavbaranov <pavbaranov at gmail dot com>
pkgname=crusta
pkgver=1.4.3.1
pkgrel=1
pkgdesc="Fast, secure, and free web browser built for the modern web."
arch=('x86_64')
url="http://www.crustabrowser.com/"
license=('GPL3')
depends=('qt5-speech' 'qt5-webengine')
makedepends=('qt5-charts')
optdepends=('pepper-flash')
conflicts=(crusta-browser crusta-browser-git)
source=("https://github.com/CrustaBrowser/CrustaBrowser/archive/${pkgver}.tar.gz")
sha256sums=('5181bc8f3677fa31ebf312744577f679e385ad60e88069eed6f45fe774e1f548')

prepare() {
    rm -rf build
    mkdir build
    }
    
build() {
  cd build 
  qmake $srcdir/CrustaBrowser-$pkgver/$pkgname/$pkgname.pro
  make
  }

package() {
  cd build
#  cd $srcdir/CrustaBrowser-$pkgver/$pkgname
  install -Dm755 $pkgname "${pkgdir}/usr/bin/$pkgname"
  install -Dm644 $srcdir/CrustaBrowser-$pkgver/$pkgname/res/drawables/icon.svg "$pkgdir/usr/share/icons/hicolor/scalable/apps/$pkgname.svg"
  sed "/^Exec=/ s/Exec=.*/Exec=crusta/" -i $srcdir/CrustaBrowser-$pkgver//Crusta.desktop
  sed "/^Icon=/ s/Icon=.*/Icon=crusta/" -i $srcdir/CrustaBrowser-$pkgver//Crusta.desktop
  install -Dm755 $srcdir/CrustaBrowser-$pkgver//Crusta.desktop "$pkgdir/usr/share/applications/$pkgname.desktop"
}
