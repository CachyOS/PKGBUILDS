# Maintainer: pavbaranov <pavbaranov at gmail dot com>
# Contributor: Damian N. <nycko123 at gmail>

pkgname=clamav-gui
_pkgname=ClamAV-GUI
pkgver=0.4.1
pkgrel=3
pkgdesc='Front-end for ClamAV'
arch=('x86_64')
url='https://www.opendesktop.org/p/1127892/'
license=('GPL3')
depends=('qt5-base' 'hicolor-icon-theme' 'clamav')
#makedepends=()
#optdepends=('clamav: For functionality')

source=("170782-ClamAV-GUI-0.4.1.tgz"
		"clamav-gui-pl_PL.ts"
		"clamav-gui-pl_PL.patch"
		"clamav-gui-pl_PL.qm")
sha512sums=('2f289a1ec91bd56a440ad749bd2e42a3b5d21859d35c2079517ad707fa402ace917cfe5b0c858833bc554015a47efa60cb8e0b69a0efce06350814cd30abc430'
            'bb3cca28c9b9bdcecc47a27bd5f78aa884c2b3a829064af49a69e38681eee666a790a60aca3d922c624b235258d076d2094fe4b9bb2f3e84c777ec99e24bfa04'
            'fb38e0200c4550c3269d4b960e0da3b84a646ef1bbe98c3e136c2b5d193de43091e1179dd30a72c47e3e620c226c0586bcced310922ddaab6ba27f70218185f2'
            'fa8c3f4565c6c56d6450f7c94dfef1b9da1f5a0fbccae38b967f748571d281ccdf6702a33e38c2cf4b14b728547c74a0fb03c7e6244aa8bcca188d38d19c8726')

# kopiuje tylko pliki tłumaczeń i dodaje odwołania do nich w Makefile oraz clamav-gui.pro, nie ma wpływu na ostateczny rezultat
prepare() {
	cp ../clamav-gui-pl_PL.{qm,ts} "${srcdir}/${_pkgname}/translations/"
	patch -p1 < "../clamav-gui-pl_PL.patch"
}

build() {
  cd $_pkgname
  qmake PREFIX=/usr clamav-gui.pro
  make
}

package() {
  cd $_pkgname
  make INSTALL_ROOT="$pkgdir" install
  install -Dm644 "$srcdir/clamav-gui-pl_PL.qm" "$pkgdir/usr/share/clamav-gui/"
}
